/*
**author:jasonYang**
**web:jasonwap.zglingjie.com**
**email:914412726@qq.com**
*/
define("jasonweb/jasonUtil",["jquery"],function(require,exports,module){var $=require("jquery"),nundefined,jasonUtil={ajaxMask:"mask",lockMask:0,maskNode:null};jasonUtil.isObject=function(a){return"object"==typeof a&&null!==a},jasonUtil.isArray=function(a){return a instanceof Array&&a.push!=nundefined},jasonUtil.showMask=function(a){var b=this,a=a||"请求中...",c=$(".jasonUtilMaskNode");if(b.lockMask=1,"mask"==b.ajaxMask)if("object"==typeof jl&&"function"==typeof jl.showMask)jl.showMask(a,!0);else{if(c.length<=0){var d='<div class="jasonUtilMaskNode" style="position:fixed;top:50%;left:50%;min-width:220px;max-width:500px;line-height:26px;padding:10px 0;background-color:#000;opacity:0.6;filter: alpha(opacity=60);z-index:9999;text-align:center;border-radius:4px;"><div class="jasonUtilMaskNodeBg" style="position:fixed;left:0;top:0;width:100%;height:100%;z-index:9998;background-color:#000;opacity:0;filter: alpha(opacity=0);"></div><div class="jasonUtilMaskNodeImg" style="position:relative;z-index:9999;">'+(!b.isStrEmpty(b.imgUrl)||"object"==typeof jl&&"object"==typeof jl.params&&!b.isStrEmpty(jl.params.ldImg)?'<img src="'+(b.isStrEmpty(b.imgUrl)?b.imgUrl:jl.params.ldImg)+'" />':"")+'</div><div class="jasonUtilMaskNodeText" style="color:#fff;font-size:14px;padding:10px 15px 0;position:relative;z-index:9999;">'+a+"</div>";$("body").append(d),c=$(".jasonUtilMaskNode")}else c.find(".jasonUtilMaskNodeText").html(a);$(".jasonUtilMaskNode").css({"margin-left":-c.width()/2,"margin-top":-c.height()/2})}},jasonUtil.hideMask=function(){var a=this,b=$(".jasonUtilMaskNode");if(a.lockMask=0,"object"==typeof jl&&"function"==typeof jl.hideMask)jl.hideMask();else{var c=function(){b.length>0&&!a.lockMask&&b.remove()};setTimeout(c,10)}},jasonUtil.flashMask=function(a,b,c){var d=this;d.showMask(a),setTimeout(function(){d.hideMask(),"function"==typeof b?b():"function"==typeof c&&c()},isNaN(b)?2e3:b)},jasonUtil.getScrollTop=function(){return"pageYOffset"in window?window.pageYOffset:"BackCompat"===document.compatMode?document.body.scrollTop:document.documentElement.scrollTop},jasonUtil.setScrollTop=function(a){window.pageYOffset=a,document.body.scrollTop=a,document.documentElement.scrollTop=a},jasonUtil.getDocumentHeight=function(){return document.body.clientHeight||document.documentElement.clientHeight},jasonUtil.gotoUrl=function(a,b){var c=this;c.showMask("加载中..."),window.setTimeout(function(){c.hideMask(),window.location.href=a},isNaN(b)?300:b)},jasonUtil.openUrl=function(a,b,c,d){var e=this;c=c?c:"toolbar=yes,menubar=yes,scrollbars=yes,resizable=yes,location=yes,status=yes","number"==typeof b?d=b:"number"==typeof c?d=c:"number"!=typeof d&&(d=300),e.showMask("加载中..."),window.open(a,b,c),window.setTimeout(function(){e.hideMask()},d)},jasonUtil.isStrEmpty=function(a){return null==a?!0:"null"==a?!0:"undefined"==typeof a?!0:""==typeof a?!0:"\n"==typeof a?!0:0==a.length?!0:!1},jasonUtil.ajaxJson=function(type,url,data,callback,time){var self=this;"mask"==self.ajaxMask&&self.showMask();var d=new Date;url=url+"?"+d.getTime(),$.ajax({type:type,url:url,data:data,success:function(data){if(self.hideMask(),"function"!=typeof callback||callback instanceof RegExp)return self.flashMask("错误提示：请传入正确的回调函数");try{var rsp;rsp="string"!=typeof data?data:self.isStrEmpty(JSON)?JSON.parse(data):eval("("+data+")")}catch(e){self.flashMask("undefined"==typeof interface_return_data_error||self.isStrEmpty(interface_return_data_error)?"请求失败：后端数据接口返回json数据格式错误！":interface_return_data_error,isNaN(time)?3e3:time)}callback(rsp)},error:function(){self.hideMask(),self.flashMask("undefined"==typeof ajax_error||self.isStrEmpty(ajax_error)?"请求失败：网络出错或超时！":ajax_error,isNaN(time)?3e3:time)}})},jasonUtil.getJson=function(a,b,c,d){this.ajaxJson("get",a,b,c,d)},jasonUtil.postJson=function(a,b,c,d){this.ajaxJson("post",a,b,c,d)},jasonUtil.radioVal=function(a){var b="";return $(a).each(function(){this.checked&&(b=this.value)}),b},jasonUtil.getParam=function(a){for(var b=window.location.href,c=b.substring(b.indexOf("?")+1),d=c.split("&"),e=0;e<d.length;e++){var f=d[e].split("=");if(f[0]==a)return f[1].indexOf("#")>=0?f[1].substring(0,f[1].indexOf("#")):f[1]}return""},jasonUtil.stringify=function(a){var b=this;if(b.isArray(a)){for(var c="[",d=0;d<a.length;d++)c+=(d>0?",":"")+b.stringify(a[d]);return c+="]"}if(b.isObject(a)){var c="{",d=0;for(var e in a)c+=(d>0?",":"")+'"'+e+'":'+b.stringify(a[e]),d++;return c+="}"}return"number"==typeof a?a:"string"==typeof a?'"'+a+'"':'""'},jasonUtil.getTime=function(a){for(var b=this,c=a.split(" "),d=[],e=[],f=0;f<c.length;f++)c[f].indexOf("-")>=0?d=c[f].split("-"):c[f].indexOf("/")>=0?d=c[f].split("/"):c[f].indexOf(":")>=0&&(e=c[f].split(":"));d.length>0&&3!=d.length&&b.flashMask("日期格式错误"),e.length>0&&2!=e.length&&3!=e.length&&b.flashMask("时间格式错误");for(var f=0;f<d.length;f++)d[f]=parseInt(d[f],10);for(var f=0;f<e.length;f++)e[f]=parseInt(e[f],10);2==e.length&&(e[2]=0);var g=new Date;return 3==d.length&&g.setFullYear(d[0],d[1]-1,d[2]),3==e.length?g.setHours(e[0],e[1],e[2]):g.setHours(0,0,0),g.getTime()},module.exports=jasonUtil});