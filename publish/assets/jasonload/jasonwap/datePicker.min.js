/*
**author:jasonYang**
**web:jasonwap.zglingjie.com**
**email:914412726@qq.com**
*/
function setday(a,b,c,d,e){return null==a?null:void new Calendar(a,b,c,d,e).show()}function setmonth(a,b,c,d,e){return null==a?null:void new Calendar(a,b,c,d,e,"m").show()}function getFrameDocument(a){if(a.contentDocument)var b=a.contentDocument;else if(a.contentWindow)var b=a.contentWindow.document;return b}function checkDate(a,b,c){var d=["31","28","31","30","31","30","31","31","30","31","30","31"],e="";return a%4==0&&(d[1]="29"),e=c>d[b]?d[b]:c}function Calendar(a,b,c,d,e,f){this.beginDate="1900-01-01".toDate(),this.endDate="2020-01-01".toDate(),this.lang=0,this.type="d",this.dateFormatStyle="yyyy-MM-dd",null!=f&&(this.type=f,"m"==this.type&&(this.dateFormatStyle="yyyy-MM")),null!=b&&(this.dateFormatStyle=b),this.currentDate=new Date;var g=new Date;null!=a.value&&""!=a.value&&(g=a.value.toDate(this.dateFormatStyle)),this.date=null!=g?g:new Date,null!=c&&(this.beginDate=c),null!=d&&(this.endDate=d),null!=e&&(this.lang=e),this.dateControl=a,this.panel=document.getElementById("calendarPanel"),this.iframe=document.getElementById("calendarIframe"),this.isFocus=!1,this.draw()}function getElementsByClassName(a,b,c){var d="*"==b&&a.all?a.all:a.getElementsByTagName(b),e=new Array;c=c.replace(/\-/g,"\\-");for(var f,g=new RegExp("(^|\\s)"+c+"(\\s|$)"),h=0;h<d.length;h++)f=d[h],g.test(f.className)&&e.push(f);return e}Calendar.prototype.style=function(){var a="<style type='text/css'>";return a+=".calendar {font-size:12px; margin:0;padding:0px;border:1px solid #397EAE;background-color:#DBE7F2;}",a+=".calendar ul {list-style-type:none; margin:0; padding:0;vertical-align:middle;}",a+=".calendar li {float:left;}.calendar b{font-weight:bold;}",a+=".calendar .day li {height:20px;}",a+=".calendar .day li,.calendar .date li{float:left;width:14.13%;height:30px;line-height:30px;text-align:center;}",a+=".calendar .day li{font-weight:bold;} .calendar .date li{background-color:#EDF3F9;}",a+=".calendar .month li{float:left;width:24.8%;height:30px;line-height:30px;text-align:center;background-color:#EDF3F9;}",a+=".calendar li a{ text-decoration:none; font-family:Tahoma; font-size:11px; color:#333}",a+=".calendar li:hover {cursor:pointer;color:#f30; text-decoration:none;background-color:#EDF3F9;}",a+=".calendar .date li:hover, .calendar .month li:hover{cursor:pointer;color:#f30; text-decoration:none;background-color:#DBE7F2;}",a+=".calendarlihover {color:#f30;text-decoration:none;background-color:#E8F2FE;}",a+=".calendar li a.hasArticle {font-weight:bold; color:#f60 !important}",a+=".lastMonthDate, .nextMonthDate {color:#bbb;font-size:11px}",a+=".selectThisYear, .selectThisMonth{text-decoration:none; margin:0px; color:#000; font-weight:bold}",a+=".calendar .LastMonth, .calendar .NextMonth{text-decoration:none; color:#000; font-size:18px; font-weight:bold; line-height:16px;}",a+=".calendarTitle{background:#EDF3F9;text-align:center;height:30px;line-height:30px;clear:both;width:100%;}",a+=".calendarTitle option{height:22px;line-height:22px;}",a+=".calendarTitle .mark{text-decoration:none;color:#000;font-family:Tahoma;font-size:18px;font-weight:normal;}",a+=".today{ background-color:#ffffaa;border:1px solid #f60;padding:3px;}",a+=".today a { color:#f30; }",a+=".calendarBottom {text-align:center;height:30px;line-height:30px;clear:both;width:100%;border-top:1px solid #ddd;}",a+=".calendarBottom li{float:left;height:30px;line-height:30px;font-weight:bold;text-align:center;}",a+="</style>"},String.prototype.toDate=function(a){null==a&&(a="yyyy-MM-dd");var b,c=a.replace("yyyy","(\\~1{4})").replace("yy","(\\~1{2})").replace("MM","(\\~1{2})").replace("M","(\\~1{1,2})").replace("dd","(\\~1{2})").replace("d","(\\~1{1,2})").replace(/~1/g,"d");if(new RegExp(c).test(this)){var d=a.indexOf("yyyy"),e=a.indexOf("MM"),f=a.indexOf("dd");-1==e&&(e=a.indexOf("M")),-1==d&&(d=a.indexOf("yy")),-1==f&&(f=a.indexOf("d"));for(var g=new Array(d+"y",e+"m",f+"d"),h={y:0,m:0,d:1},i=this.match(c),j=1;j<i.length;j++){if(0==j)return;var k=g[j-1].split("")[1];h[k]=i[j]}2==h.y.toString().length&&(h.y=parseInt("20"+h.y)),h.m=h.m-1,b=new Date(h.y,h.m,h.d)}return(null==b||isNaN(b))&&(b=new Date),b},Date.prototype.format=function(a){var b={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"w+":"鏃ヤ竴浜屼笁鍥涗簲鍏�".charAt(this.getDay()),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(a)&&(a=a.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var c in b)new RegExp("("+c+")").test(a)&&(a=a.replace(RegExp.$1,1==RegExp.$1.length?b[c]:("00"+b[c]).substr((""+b[c]).length)));return a},Date.prototype.dateAdd=function(a,b){switch(a){case"y":return new Date(this.getFullYear()+b,this.getMonth(),this.getDate());case"m":return new Date(this.getFullYear(),this.getMonth()+b,checkDate(this.getFullYear(),this.getMonth()+b,this.getDate()));case"d":return new Date(this.getFullYear(),this.getMonth(),this.getDate()+b);case"w":return new Date(this.getFullYear(),this.getMonth(),7*b+this.getDate())}},Calendar.language={title:[["",""],["骞�","鏈�"]],months:[["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"],["涓€鏈�","浜屾湀","涓夋湀","鍥涙湀","浜旀湀","鍏湀","涓冩湀","鍏湀","涔濇湀","鍗佹湀","鍗佷竴鏈�","鍗佷簩鏈�"]],weeks:[["S","M","T","W","T","F","S"],["鏃�","涓€","浜�","涓�","鍥�","浜�","鍏�"]],weekday:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],clear:[["Clear"],["娓呯┖"]],today:[["Today","Current"],["浠婂ぉ","褰撴湀"]],close:[["Close"],["鍏抽棴"]]},Calendar.prototype.draw=function(){var a=this.date.format("yyyy-MM").toDate("yyyy-MM");a<this.beginDate&&(this.date=this.beginDate),a>this.endDate&&(this.date=this.endDate),this.year=this.date.getFullYear(),this.month=this.date.getMonth();var b='<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />'+this.style()+'</head><body style="padding:0px;margin:0px;">',c=this.date.dateAdd("d",1-this.date.getDate()),d=c.dateAdd("d",-1),e=c.getDay();d=d.getDate();var f=c.dateAdd("m",1).dateAdd("d",-1),g=f.getDate(),h=f.getDay(),i="<div id='calendar' class='calendar' style='width:";if(i+="d"==this.type?"250":"220",i+="px;'>",i+="<div class='calendarTitle'><ul>",i+="<li id='PrevYear' class='mark' style='width:12%;' title='Previous Year'>&laquo;</li>","d"==this.type){i+="<li id='PrevMonth' class='mark' style='width:12%;' title='Previous Month'>&lsaquo;</li>",i+="<li style='width:30%;'><span id='selectThisYear' class='selectThisYear'>"+this.date.getFullYear()+"</span>"+Calendar.language.title[this.lang][0]+"</li>",i+=0==this.lang?"<li style='width:20%;'><span id='selectThisMonth' class='selectThisMonth'>"+Calendar.language.months[this.lang][this.date.getMonth()]+"</span></li>":"<li style='width:20%;'><span id='selectThisMonth' class='selectThisMonth'>"+(this.date.getMonth()+1)+"</span>"+Calendar.language.title[this.lang][1]+"</li>",i+="<li id='NextMonth' class='mark' style='width:12%;' title='Next Month'>&rsaquo;</li>",i+="<li id='NextYear' class='mark' style='width:12%;' title='Next Year'>&raquo;</li></ul></div>",i+="<div class='calendarBody'>",i+="<ul class='day'>";for(var j=0;j<Calendar.language.weeks[this.lang].length;j++)i+="<li title='"+Calendar.language.weekday[j]+"'>"+Calendar.language.weeks[this.lang][j]+"</li>";i+="</ul><ul class='date' id='thisMonthDate'>";for(var k="",j=0;e>j;j++)k="<li class='lastMonthDate'>"+d+"</li>"+k,d--;for(i+=k,j=1;g>=j;j++){var l=c.dateAdd("d",j-1);l<this.beginDate||l>this.endDate?i+="<li class='lastMonthDate'>"+j+"</li>":(i+="<li class='thisMonth' title='"+l.format("yyyy-MM-dd")+"'><a href='javascript:void(0);' ",l.format("yyyy-MM-dd")==this.date.format("yyyy-MM-dd")&&(i+="class='today' "),i+=">"+j+"</a></li>")}var m=1;for(j=h;6>j;j++)i+="<li class='nextMonthDate'>"+m+"</li>",m++;i+="</ul>",i+="</div>",i+="<div class='calendarBottom'><ul>",i+="<li id='emptyCalendar' style='width:27%;' title='Clear'>"+Calendar.language.clear[this.lang]+"</li>",i+="<li id='selectCurrent' style='width:45%;' title='Today'>"+Calendar.language.today[this.lang][0]+"</li>"}else{i+="<li style='width:74%;'><span id='selectThisYear' class='selectThisYear'>"+this.date.getFullYear()+"</span>"+Calendar.language.title[this.lang][0]+"</li>",i+="<li id='NextYear' class='mark' style='width:12%;' title='Next Year'>&raquo;</li></ul></div>",i+="<div class='calendarBody'>",i+="</ul><ul class='month' id='thisMonth'>";for(var j=1;12>=j;j++){var l=(this.year+"-"+(j>9?j:"0"+j)).toDate("yyyy-MM");l<this.beginDate||l>this.endDate?i+="<li class='lastMonthDate'>"+j+"</li>":(i+="<li class='thisMonth' title='"+this.year+"-"+(j>9?j:"0"+j)+"-01'><a href='javascript:void(0);'",this.year+"-"+(j>9?j:"0"+j)==this.date.format("yyyy-MM")&&(i+=" class='today' "),i+=">"+j+"</a></li>")}i+="</ul>",i+="</div>",i+="<div class='calendarBottom'><ul>",i+="<li id='emptyCalendar' style='width:27%;' title='Clear'>"+Calendar.language.clear[this.lang]+"</li>",i+="<li id='selectCurrent' style='width:45%;' title='Current Month'>"+Calendar.language.today[this.lang][1]+"</li>"}i+="<li id='closeCalendar' style='width:27%;' title='Close'>"+Calendar.language.close[this.lang]+"</li>",i+="</ul></div>",i+="</div>",i+="</body></html>";var n=getFrameDocument(this.iframe);n.writeln(b),n.writeln(i),n.close(),this.document=n,this.bingEvent()},Calendar.prototype.bingEvent=function(){var a=this;this.setAutoHeight(),a.isFocus=!0,this.panel.onmouseover=function(){a.isFocus=!0},this.dateControl.onblur=function(){a.isFocus||a.hide()},this.getElementById("selectCurrent").onclick=function(){a.date=new Date,a.valueSelected(a.date),a.hide()},this.getElementById("emptyCalendar").onclick=function(){a.dateControl.value="",a.hide()},this.getElementById("closeCalendar").onclick=function(){a.hide()},this.getElementById("PrevYear").onclick=function(){a.date=a.date.dateAdd("y",-1),a.draw()},this.getElementById("PrevMonth")&&(this.getElementById("PrevMonth").onclick=function(){a.date=a.date.dateAdd("m",-1),a.draw()},this.getElementById("NextMonth").onclick=function(){a.date=a.date.dateAdd("m",1),a.draw()}),this.getElementById("NextYear").onclick=function(){a.date=a.date.dateAdd("y",1),a.draw()},this.getElementById("selectThisYear").onclick=function(){a.selectThisYear(),a.getElementById("selectThisYear").onclick=null},"d"==this.type&&(this.getElementById("selectThisMonth").onclick=function(){a.selectThisMonth(),a.getElementById("selectThisMonth").onclick=null});for(var b=getElementsByClassName(this.document,"li","thisMonth"),c=0;c<b.length;c++)b[c].onclick=function(){a.date=this.title.toDate(),a.valueSelected(a.date),a.hide()}},Calendar.prototype.selectThisYear=function(){for(var a=this,b=this.date.getFullYear(),c=this.beginDate.getFullYear(),d=this.endDate.getFullYear(),e=this.getElementById("selectThisYear"),f="<select style='font-size:10px;'>",g=d;g>=c;g--)f+="<option value='"+g+"'>"+g+"</option>";f+="</select>",e.innerHTML=f;var h=e.childNodes[0];h.value=b,h.onchange=function(){a.date.setFullYear(h.value),a.draw()}},Calendar.prototype.selectThisMonth=function(){var a=this,b=this.date.getMonth()+1,c=this.date.getFullYear(),d=this.endDate.getFullYear(),e=12;c==d&&(e=this.endDate.getMonth+1);for(var f=this.getElementById("selectThisMonth"),g="<select style='font-size:10px;'>",h=1;e>=h;h++)g+="<option value='"+h+"'>"+Calendar.language.months[this.lang][h-1]+"</option>";g+="</select>",f.innerHTML=g;var i=f.childNodes[0];i.value=b,i.onchange=function(){a.date.setMonth(i.value-1),a.draw()}},Calendar.prototype.valueSelected=function(a){this.dateControl.value=a.format(this.dateFormatStyle)},Calendar.prototype.setAutoHeight=function(){var a=this.document.body.scrollHeight+"px",b=this.getElementById("calendar").style.width;b=parseInt(b.substr(0,b.length-1))+2+"px",this.iframe.style.height=a,this.panel.style.height=a,this.panel.style.width=b},Calendar.prototype.getElementById=function(id){if("string"!=typeof id||""==id)return null;if(null==this.document)return null;if(this.document.getElementById)return this.document.getElementById(id);if(this.document.all)return this.document.all(id);try{return eval(id)}catch(e){return null}},Calendar.prototype.getElementsByTagName=function(a){return null==this.document?null:this.document.getElementsByTagName?this.document.getElementsByTagName(a):this.document.all?this.document.all.tags(a):void 0},Calendar.prototype.getAbsPoint=function(a){for(var b=a.offsetLeft,c=a.offsetTop;a=a.offsetParent;)b+=a.offsetLeft,c+=a.offsetTop;return{x:b,y:c}},Calendar.prototype.show=function(){var a=this.getAbsPoint(this.dateControl);this.panel.style.left=a.x+"px",this.panel.style.top=a.y+this.dateControl.offsetHeight+"px",this.setDisplayStyle("select","hidden"),this.panel.style.visibility="visible"},Calendar.prototype.hide=function(){this.setDisplayStyle("select","visible"),this.panel.style.visibility="hidden",this.isFocus=!1},Calendar.prototype.setDisplayStyle=function(a,b){for(var c=this.getElementsByTagName(a),d=0;d<c.length;d++)("select"!=a.toLowerCase()||"calendarYear"!=c[d].name&&"calendarMonth"!=c[d].name)&&(c[d].style.visibility=b)},document.write('<div id="calendarPanel" style="position:absolute;visibility:hidden;z-index:9999;font-size:12px;">'),document.write("<iframe id='calendarIframe' scrolling='no' frameborder='0' width='100%' height='100%'></iframe></div>");