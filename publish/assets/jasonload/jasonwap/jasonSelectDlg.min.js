/*
**author:jasonYang**
**web:jasonwap.zglingjie.com**
**email:914412726@qq.com**
*/
define("jasonwap/jasonSelectDlg",["appframework","./jasonPopup"],function(a,b,c){var d=a("./jasonPopup");!function(a){a.fn.jasonSelectDlg=function(b,c){a.isArray(b)||(c||(c=b),b=[]);var d,e=a(this),f=a.extend({},{singleSelect:!0,value:"value",text:"text",dataList:b,isBindClick:!0,liStyle:"",selectedStyle:"",selectedCallback:function(){},jasonPopupClass:"jasonPopup jasonSelectDlg",title:"请选择",titleLeftCallback:function(){},titleRightCallback:function(){},doneCallback:function(){},closeBtn:!0,position:"bottom",noBtn:!0,isBgClick:!0},c),g=f.value,h=f.text,i="",j=function(){if(f.singleSelect)i=e.data(g),i=i?i:"";else for(var c=e.find(".jasonSelectDlgSelectedItem"),j=0;j<c.length;j++){var k=a(c[j]);i+=k.data(g)}for(var l='<ul class="jasonSelectDlgUl">',j=0;j<b.length;j++){var m=b[j];m[g]=m[g]+"",l+=i.indexOf(m[g])>=0?"<li data-"+g+'="'+m[g]+'" data-'+h+'="'+m[h]+'" class="jasonSelectDlgSeletedLi" style="'+f.liStyle+f.selectedStyle+'">'+m[h]+'<i class="jasonSelectDlgSelectIcon"></i></li>':"<li data-"+g+'="'+m[g]+'" data-'+h+'="'+m[h]+'" style="'+f.liStyle+'">'+m[h]+"</li>"}l+="</ul>",f=a.extend({},f,{message:l,closeBtn:f.singleSelect?!0:!1,titleRightBtn:f.singleSelect?!1:!0});var n=a.jasonPopup(f),o=function(b){i=a(b).data(g),d=a(b).data(h),e.data(g,i),e.html(d);var c={};c[g]=i,c[h]=d,f.selectedCallback(c),n.remove()},p=function(b){$obj=a(b),$obj.hasClass("jasonSelectDlgSeletedLi")?($obj.removeClass("jasonSelectDlgSeletedLi"),$obj.attr("style",$obj.attr("style").replace(f.selectedStyle,"")),$obj.html($obj.html().replace('<i class="jasonSelectDlgSelectIcon"></i>',""))):($obj.addClass("jasonSelectDlgSeletedLi"),$obj.attr("style",$obj.attr("style")+f.selectedStyle),$obj.html($obj.html()+'<i class="jasonSelectDlgSelectIcon"></i>'))};if(a(".jasonSelectDlgUl li").bind("click",function(){var a=this;f.singleSelect?o(a):p(a)}),!f.singleSelect){var q=function(){var b=[],c=a(".jasonSelectDlgSeletedLi");e.empty();for(var d="",i="",j=0;j<c.length;j++){$selectedLiItem=a(c[j]);var k={};k[g]=$selectedLiItem.data(g),k[h]=$selectedLiItem.data(h),d+=(j>0?",":"")+k[g],i+=(j>0?",":"")+k[h],b.push(k),e.append('<span class="jasonSelectDlgSelectedItem" data-'+g+'="'+k[g]+'">'+k[h]+"</span>")}e.data(g,d),e.data(h,i),f.selectedCallback(b),n.remove()};a(n.popupNode).find(".jasonPopuptitleLeftBtn").unbind("click").bind("click",function(){f.titleLeftCallback(),q()}),a(n.popupNode).find(".jasonPopuptitleRightBtn").unbind("click").bind("click",function(){f.titleRightCallback(),q()}),a(n.popupNode).find(".jasonPopupBtn li").eq(1).unbind("click").bind("click",function(){f.doneCallback(),q()})}};f.isBindClick?e.unbind("click").bind("click",function(){j()}):j()}}(d),c.exports=d});